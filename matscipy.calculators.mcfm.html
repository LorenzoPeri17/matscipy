

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>matscipy.calculators.mcfm package &mdash; matscipy devel documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> matscipy
          

          
          </a>

          
            
            
              <div class="version">
                devel
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">matscipy.calculators.mcfm package</a><ul>
<li><a class="reference internal" href="#modules">Modules</a></li>
<li><a class="reference internal" href="#packages">Packages</a></li>
<li><a class="reference internal" href="#module-matscipy.calculators.mcfm.calculator">matscipy.calculators.mcfm.calculator module</a></li>
<li><a class="reference internal" href="#module-matscipy.calculators.mcfm.cluster_data">matscipy.calculators.mcfm.cluster_data module</a></li>
<li><a class="reference internal" href="#module-matscipy.calculators.mcfm.qm_cluster">matscipy.calculators.mcfm.qm_cluster module</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">matscipy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>matscipy.calculators.mcfm package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/matscipy.calculators.mcfm.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-matscipy.calculators.mcfm">
<span id="matscipy-calculators-mcfm-package"></span><h1>matscipy.calculators.mcfm package<a class="headerlink" href="#module-matscipy.calculators.mcfm" title="Permalink to this headline">¶</a></h1>
<div class="section" id="modules">
<h2>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h2>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-matscipy.calculators.mcfm.calculator" title="matscipy.calculators.mcfm.calculator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matscipy.calculators.mcfm.calculator</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-matscipy.calculators.mcfm.cluster_data" title="matscipy.calculators.mcfm.cluster_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matscipy.calculators.mcfm.cluster_data</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-matscipy.calculators.mcfm.qm_cluster" title="matscipy.calculators.mcfm.qm_cluster"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matscipy.calculators.mcfm.qm_cluster</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="packages">
<h2>Packages<a class="headerlink" href="#packages" title="Permalink to this headline">¶</a></h2>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="matscipy.calculators.mcfm.mcfm_parallel.html#module-matscipy.calculators.mcfm.mcfm_parallel" title="matscipy.calculators.mcfm.mcfm_parallel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matscipy.calculators.mcfm.mcfm_parallel</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="matscipy.calculators.mcfm.neighbour_list_mcfm.html#module-matscipy.calculators.mcfm.neighbour_list_mcfm" title="matscipy.calculators.mcfm.neighbour_list_mcfm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matscipy.calculators.mcfm.neighbour_list_mcfm</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="matscipy.calculators.mcfm.qm_cluster_tools.html#module-matscipy.calculators.mcfm.qm_cluster_tools" title="matscipy.calculators.mcfm.qm_cluster_tools"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matscipy.calculators.mcfm.qm_cluster_tools</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-matscipy.calculators.mcfm.calculator">
<span id="matscipy-calculators-mcfm-calculator-module"></span><h2>matscipy.calculators.mcfm.calculator module<a class="headerlink" href="#module-matscipy.calculators.mcfm.calculator" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential">
<em class="property">class </em><code class="sig-prename descclassname">matscipy.calculators.mcfm.calculator.</code><code class="sig-name descname">MultiClusterForceMixingPotential</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atoms</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">classical_calculator</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">qm_calculator</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">qm_cluster</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">forced_qm_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">change_bonds</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">calculate_errors</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">calculation_always_required</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">buffer_hops</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">enable_check_state</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ase.calculators.calculator.Calculator</span></code></p>
<p>Subclass of ASE.Calculator facilitating a support for multiple
QM clusters. It utilizes the given classical_calculator and qm_calculator to initialize
an instace of ForceMixingPotential</p>
<dl class="simple">
<dt>Extends:</dt><dd><p>Calculator</p>
</dd>
<dt>Variables:</dt><dd><p>implemented_properties {list} – [“energy”, “forces”, “potential_energies”, “stress”]
all_changes {list} – [‘positions’, ‘numbers’, ‘cell’, ‘pbc’]</p>
</dd>
</dl>
<dl class="py attribute">
<dt id="matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.all_changes">
<code class="sig-name descname">all_changes</code><em class="property"> = ['positions', 'numbers', 'cell', 'pbc']</em><a class="headerlink" href="#matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.all_changes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.attach_hybrid_data">
<code class="sig-name descname">attach_hybrid_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atoms</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">full_qm_atoms_mask</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cluster_data</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.attach_hybrid_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark atoms that are treated quantm mmechanically
for more comprehensive ooutput</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>ASE.atoms</em>) – atoms object</p></li>
<li><p><strong>full_qm_atoms_mask</strong> (<em>list</em>) – list of all qm atoms</p></li>
<li><p><strong>cluster_data_list</strong> (<em>list of matscipy.calculators.mcfm.ClusterData</em>) – information about the clusters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.calculate">
<code class="sig-name descname">calculate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atoms</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">properties</span><span class="o">=</span><span class="default_value">['energy']</span></em>, <em class="sig-param"><span class="n">system_changes</span><span class="o">=</span><span class="default_value">['positions', 'numbers', 'cell', 'pbc']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate selected properties of the given Atoms object.
Initially, a classical potential is called to evaluate potential
energies for each atom and afterwards a qm_cluster object is employed
to analyze them. If no atom is flagged for QM treatment, classical forces
are returned. In case some atoms are flagged for QM treatment
each Qm cluster is independently send to a qmmm potential to evaluate
more accurate forces. The results of qmmm evaluations are used to modify
the classical forces and the final array is given</p>
<p>energy = potential energy from classical evaluation
potential energies = pot energy per atom from classical evaluation
forces = classical or qmmm forces depending on whether any atoms are flagged</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>ASE.atoms</em>) – atoms object</p></li>
<li><p><strong>properties</strong> (<em>list</em>) – properties ot evaluate</p></li>
<li><p><strong>system_changes</strong> (<em>TYPE</em>) – changes in the system</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>AttributeError</strong> – Must provide an atoms object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.combine_qm_mm_forces">
<code class="sig-name descname">combine_qm_mm_forces</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atoms</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">forces</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cluster_data_list</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.combine_qm_mm_forces" title="Permalink to this definition">¶</a></dt>
<dd><p>This combines QM and MM forces</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>ASE.atoms</em>) – atoms object</p></li>
<li><p><strong>forces</strong> (<em>np.array</em>) – atomic forces</p></li>
<li><p><strong>cluster_data_list</strong> (<em>list of matscipy.calculators.mcfm.ClusterData</em>) – information about the clusters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>forces</strong> – atomic forces</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.compute_stress">
<code class="sig-name descname">compute_stress</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atoms</span></em>, <em class="sig-param"><span class="n">forces</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.compute_stress" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute total stresses using viral theorem.
WARNING: only works for non-PBC structures</p>
<p>Sij = sum_k (m_k v_ik v_jk)/ volume + sum_k (r_ik f_jk)/volume
m: mass
v: velocity
r: position
f: force
where i,j are taken from {x, y, z}
and sum_k represents a sum over all atoms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>ASE.atoms</em>) – atoms object</p></li>
<li><p><strong>forces</strong> (<em>np.array</em>) – atomic forces</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>stress</strong> – stress tensof in matrix notation</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.evaluate_errors">
<code class="sig-name descname">evaluate_errors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atoms</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">heavy_only</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">r_force</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.evaluate_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the forces and reference forces to get errors on hybrid atom
force evaluations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>ASE.atoms</em>) – atoms object</p></li>
<li><p><strong>heavy_only</strong> (<em>bool</em>) – Do not evaluate errors on hydrogens</p></li>
<li><p><strong>r_force</strong> (<em>np.array</em>) – array with reference forces</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.evaluate_qm_cluster_serial">
<code class="sig-name descname">evaluate_qm_cluster_serial</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atoms</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cluster</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">clusterNumber</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.evaluate_qm_cluster_serial" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate forces for a single QM cluster given the buffer hops</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>ASE.atoms</em>) – atoms object</p></li>
<li><p><strong>cluster</strong> (<em>list</em>) – list of core qm atoms</p></li>
<li><p><strong>clusterNumber</strong> (<em>int</em>) – cluster number</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>Cluster</strong> –</p>
<dl class="simple">
<dt>object with forces</dt><dd><p>qm_atoms mark
core qm list</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>cluster_data</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.implemented_properties">
<code class="sig-name descname">implemented_properties</code><em class="property">: List<span class="p">[</span>str<span class="p">]</span></em><em class="property"> = ['energy', 'forces', 'potential_energies', 'stress']</em><a class="headerlink" href="#matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.implemented_properties" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.print_message">
<code class="sig-name descname">print_message</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">message</span></em>, <em class="sig-param"><span class="n">limit</span><span class="o">=</span><span class="default_value">100</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.print_message" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a message if the calculators verbosity level is above the
given threshold</p>
<p>0 - nothing is printed
1 - Message when meth::calculate is called
10 - Calculate steps are listed
100 - Information about specific QM clusters
(the default is 0)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>str</em>) – The message to be printed</p></li>
<li><p><strong>limit</strong> (<em>int</em>) – the verbosity threshold for this mesage</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.produce_classical_results">
<code class="sig-name descname">produce_classical_results</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atoms</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.produce_classical_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Call the classical potential ot obtain forces, potential energy
and potential energies per atom</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atoms</strong> (<em>ASE.atoms</em>) – atoms object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>forces</strong> (<em>np.array</em>) – Atomic forces</p></li>
<li><p><strong>potential_energy</strong> (<em>np.array</em>) – Potential energy of the system</p></li>
<li><p><strong>potential_energies</strong> (<em>np.array</em>) – Per atom potential energies</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.produce_qm_clusters">
<code class="sig-name descname">produce_qm_clusters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atoms</span></em>, <em class="sig-param"><span class="n">potential_energies</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.produce_qm_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Update qm clusters based on potential energies per atom</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>ASE.atoms</em>) – atoms object</p></li>
<li><p><strong>potential_energies</strong> (<em>np.array</em>) – Per atom potential energies</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.set_qm_atoms">
<code class="sig-name descname">set_qm_atoms</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">qm_list</span></em>, <em class="sig-param"><span class="n">atoms</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.calculator.MultiClusterForceMixingPotential.set_qm_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Force a certian set of clusters for qmmm evaluation,
If forced_qm_list is assigned, the cluster list is not updated
throughout the run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qm_list</strong> (<em>list</em>) – list of atoms</p></li>
<li><p><strong>atoms</strong> (<em>ASE.atoms</em>) – atoms object</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-matscipy.calculators.mcfm.cluster_data">
<span id="matscipy-calculators-mcfm-cluster-data-module"></span><h2>matscipy.calculators.mcfm.cluster_data module<a class="headerlink" href="#module-matscipy.calculators.mcfm.cluster_data" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="matscipy.calculators.mcfm.cluster_data.ClusterData">
<em class="property">class </em><code class="sig-prename descclassname">matscipy.calculators.mcfm.cluster_data.</code><code class="sig-name descname">ClusterData</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nAtoms</span></em>, <em class="sig-param"><span class="n">mark</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">qm_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">forces</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.cluster_data.ClusterData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for storing cluster data</p>
<dl class="py attribute">
<dt id="matscipy.calculators.mcfm.cluster_data.ClusterData.forces">
<code class="sig-name descname">forces</code><a class="headerlink" href="#matscipy.calculators.mcfm.cluster_data.ClusterData.forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic forces</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="matscipy.calculators.mcfm.cluster_data.ClusterData.mark">
<code class="sig-name descname">mark</code><a class="headerlink" href="#matscipy.calculators.mcfm.cluster_data.ClusterData.mark" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Marks assigning atoms as:</dt><dd><p>1: core QM region
2: buffer region
3: terminal atoms (final atom included in the buffer region)
4: additional terminal atoms
5: Hydrogens used ot terminate cut-off bonds</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="matscipy.calculators.mcfm.cluster_data.ClusterData.qm_list">
<code class="sig-name descname">qm_list</code><a class="headerlink" href="#matscipy.calculators.mcfm.cluster_data.ClusterData.qm_list" title="Permalink to this definition">¶</a></dt>
<dd><p>list of inner QM atoms</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-matscipy.calculators.mcfm.qm_cluster">
<span id="matscipy-calculators-mcfm-qm-cluster-module"></span><h2>matscipy.calculators.mcfm.qm_cluster module<a class="headerlink" href="#module-matscipy.calculators.mcfm.qm_cluster" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="matscipy.calculators.mcfm.qm_cluster.QMCluster">
<em class="property">class </em><code class="sig-prename descclassname">matscipy.calculators.mcfm.qm_cluster.</code><code class="sig-name descname">QMCluster</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">special_atoms_list</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.qm_cluster.QMCluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This is a class responsible for managing the QM clusters in the simulation.</p>
<blockquote>
<div><p>QM flagginig module
QM clustering module
neighbour list</p>
</div></blockquote>
<p>and contains interface to those classes</p>
<dl class="py attribute">
<dt id="matscipy.calculators.mcfm.qm_cluster.QMCluster.clustering_module">
<code class="sig-name descname">clustering_module</code><a class="headerlink" href="#matscipy.calculators.mcfm.qm_cluster.QMCluster.clustering_module" title="Permalink to this definition">¶</a></dt>
<dd><p>module responsible for carving a qm cluster</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>matscipy.calculators.mcfm.qmClusterModule.QMClusteringTool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="matscipy.calculators.mcfm.qm_cluster.QMCluster.flagging_module">
<code class="sig-name descname">flagging_module</code><a class="headerlink" href="#matscipy.calculators.mcfm.qm_cluster.QMCluster.flagging_module" title="Permalink to this definition">¶</a></dt>
<dd><p>module responsible for flagging atoms</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>matscipy.calculators.mcfm.qmClusterModule.QMFlaggingTool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="matscipy.calculators.mcfm.qm_cluster.QMCluster.neighbour_list">
<code class="sig-name descname">neighbour_list</code><a class="headerlink" href="#matscipy.calculators.mcfm.qm_cluster.QMCluster.neighbour_list" title="Permalink to this definition">¶</a></dt>
<dd><p>object holding the neighbour list</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>matscipy.calculators.mcfm.neighbour_list_mcfm.NeighborListBase</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="matscipy.calculators.mcfm.qm_cluster.QMCluster.verbose">
<code class="sig-name descname">verbose</code><a class="headerlink" href="#matscipy.calculators.mcfm.qm_cluster.QMCluster.verbose" title="Permalink to this definition">¶</a></dt>
<dd><p>Set verbosity level</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="matscipy.calculators.mcfm.qm_cluster.QMCluster.attach_clustering_module">
<code class="sig-name descname">attach_clustering_module</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.qm_cluster.QMCluster.attach_clustering_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize and attach matscipy.calculators.mcfm.QMClusteringTool
The function calls the class initializer with given parameters</p>
</dd></dl>

<dl class="py method">
<dt id="matscipy.calculators.mcfm.qm_cluster.QMCluster.attach_flagging_module">
<code class="sig-name descname">attach_flagging_module</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.qm_cluster.QMCluster.attach_flagging_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize and attach matscipy.calculators.mcfm.QMFlaggingTool
The function calls the class initializer with given parameters</p>
</dd></dl>

<dl class="py method">
<dt id="matscipy.calculators.mcfm.qm_cluster.QMCluster.attach_neighbour_list">
<code class="sig-name descname">attach_neighbour_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">neighbour_list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.qm_cluster.QMCluster.attach_neighbour_list" title="Permalink to this definition">¶</a></dt>
<dd><p>attach a neighbour list</p>
</dd></dl>

<dl class="py method">
<dt id="matscipy.calculators.mcfm.qm_cluster.QMCluster.carve_cluster">
<code class="sig-name descname">carve_cluster</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.qm_cluster.QMCluster.carve_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Interface to
self.clustering_module.carve_cluster(self,</p>
<blockquote>
<div><p>atoms,
core_qm_list,
buffer_hops=10)</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="matscipy.calculators.mcfm.qm_cluster.QMCluster.reset_energized_list">
<code class="sig-name descname">reset_energized_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.qm_cluster.QMCluster.reset_energized_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset old_energized_atoms list in flaggingModule to facilitate
MCFM potential warmup</p>
</dd></dl>

<dl class="py method">
<dt id="matscipy.calculators.mcfm.qm_cluster.QMCluster.update_qm_region">
<code class="sig-name descname">update_qm_region</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#matscipy.calculators.mcfm.qm_cluster.QMCluster.update_qm_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Interface to
self.flagging_module.update_qm_region(self,</p>
<blockquote>
<div><p>atoms,
potential_energies=None,
)</p>
</div></blockquote>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2015, James Kermode, Lars Pastewka.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>